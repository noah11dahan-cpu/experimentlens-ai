<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ExperimentLens AI - Upload</title>
</head>
<body>
    <h1>ExperimentLens AI</h1>
    <h2>Upload A/B Test Results</h2>

    <!-- IMPORTANT: this description now matches stats.py -->
    <p>
        The CSV must have columns:
        <strong>variant</strong>,
        <strong>users</strong>,
        <strong>conversions</strong>.
    </p>

    <!-- ðŸ”¹ Error message block -->
    {% if error %}
      <div style="color: red; margin-bottom: 1rem;">
        {{ error }}
      </div>
    {% endif %}

    <form action="/upload" method="post" enctype="multipart/form-data">
        <label for="experiment_name">Experiment name:</label><br>
        <!-- name MUST be "name" to match main.py -->
        <input
            type="text"
            id="experiment_name"
            name="name"
            required
            value="{{ form_name or '' }}"
        ><br><br>

        <label for="hypothesis">Hypothesis:</label><br>
        <textarea
            id="hypothesis"
            name="hypothesis"
            rows="3"
            cols="40"
            required
        >{{ form_hypothesis or '' }}</textarea><br><br>

        <label for="file">CSV file:</label><br>
        <input type="file" id="file" name="file" accept=".csv" required><br><br>

        <button type="submit">Upload and analyze</button>
    </form>

    <!-- ðŸ”¹ Optional: show existing experiments under the form -->
    {% if experiments %}
      <h2>Previous experiments</h2>
      <table border="1" cellpadding="6" cellspacing="0">
          <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Hypothesis</th>
              <th>Details</th>
          </tr>
          {% for exp in experiments %}
            <tr>
                <td>{{ exp.id }}</td>
                <td>{{ exp.name }}</td>
                <td>{{ exp.hypothesis }}</td>
                <td><a href="/experiments/{{ exp.id }}">View</a></td>
            </tr>
          {% endfor %}
      </table>
    {% endif %}
</body>
</html>
